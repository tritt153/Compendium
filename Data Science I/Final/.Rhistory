State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value) %>%
mutate(type = value =T)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value) %>%
mutate(type = value ==T)
p1 <- ggplot(features, aes(x = name, fill = name)) +
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value) %>%
mutate(type = value == T, 1)
p1 <- ggplot(features, aes(x = name, fill = name)) +
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value) %>%
mutate(count = 1) %>%
group_by(name)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name, color = name)) +
geom_histogram(stat = "count")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State,, Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True", Crossing = Crossing == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State,, Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name, color = name)) +
geom_histogram(stat = "count")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name, color = name)) +
geom_histogram(stat = "count")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name, color = State)) +
geom_histogram(stat = "count")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Crossing = Crossing == "True", Junction = Junction == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True", Stop = Stop == "True", Signal = Traffic_Signal == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = State, color = State)) +
geom_histogram(stat = "count")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Crossing, Junction, Railway, Roundabout, Stop, Signal)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = State, color = State)) +
geom_histogram(stat = "count")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Crossing, Junction, Railway,
Roundabout, Stop, Traffic_Signal) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = State, color = State)) +
geom_histogram(stat = "count")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Junction, Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = State, color = State)) +
geom_histogram(stat = "count") +
ggtitle
#Visibility affects Accidents
visibility <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
drop_na(Visibility.mi.) %>%
select(State, Visibility.mi.)
p1 <- ggplot(visibility, aes(x= Visibility.mi., color = State)) +
geom_density(adjust = 9) +
ggtitle("How Visibility Affects # of Accidents") +
xlab("Visibility (in Miles)") +
ylab("Observation Density")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = State, color = State)) +
geom_histogram(stat = "count")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = State, color = State)) +
geom_bar()
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name)) +
geom_bar()
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name, color = name)) +
geom_bar()
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name, color = name)) +
geom_bar(stat = "identity")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(State, Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name, color = name)) +
geom_bar()
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(State = State, Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name, color = name)) +
geom_bar()
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value)
p1 <- ggplot(features, aes(x = name, fill = name, color = name)) +
geom_bar() +
ggtitle("Roadway Features and # of Accidents at Them") +
xlab("Roadway Feature") +
ylab("# of Accidents")
(p1)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value) %>%
transmute(feature = name)
#what roadway features are most dangerous
features <- data %>%
filter(State == "PA" |
State == "NJ" |
State == "NY" |
State == "MD" |
State == "DE" |
State == "WV" |
State == "VA") %>%
select(Junction, Traffic_Signal, Crossing,
Stop, Railway, Roundabout) %>%
transmute(Junction = Junction == "True", Signal = Traffic_Signal == "True",
Crossing = Crossing == "True",  Stop = Stop == "True", Railway = Railway == "True",
Roundabout = Roundabout == "True") %>%
pivot_longer(cols = c(Junction, Signal, Crossing, Stop, Railway, Roundabout)) %>%
filter(value) %>%
transmute(feature = name)
p1 <- ggplot(features, aes(x = feature, fill = feature, color = feature)) +
geom_bar() +
ggtitle("Roadway Features and # of Accidents at Them") +
xlab("Roadway Feature") +
ylab("# of Accidents")
(p1)
weather <- data %>%
select(Weather_Condition, Severity) %>%
drop_na(Weather_Condition, Severity) %>%
filter(Weather_Condition == "Snow" |
Weather_Condition == "Overcast" |
Weather_Condition == "Freezing Rain" |
Weather_Condition == "Rain" |
Weather_Condition == "Clear")
data <- read.csv("US_Accidents_Dec21_updated.csv",
na = c("", " "))
